# Архитектура проекта ViewPoint

## Часть 1. Проектирование архитектуры («To Be»)

### 1. Определение типа приложения

ViewPoint представляет собой веб-приложение с клиент-серверной архитектурой, предназначенное для поиска и публикации отзывов на различные медиа-продукты (фильмы, сериалы, аниме, книги, игры и т. д.).

### 2. Стратегия развёртывания

Используется централизованный тип развертывания с возможностью масштабирования.

#### Backend:
- Развёртывание с использованием контейнеризации Docker.
- Запуск в контейнерах на выделенных серверах или облачных виртуальных машинах.

#### Frontend:
- Развёртывание через Docker-контейнеры.

### 3. Обоснование выбора технологий

#### Backend:
- **Next.js** – мощный фреймворк для создания серверных и клиентских компонентов, обеспечивает SSR и API-роутинг.
- **Prisma** – удобный ORM-инструмент для работы с базой данных.
- **PostgreSQL** – стабильная реляционная база данных для хранения пользователей, отзывов и категорий контента.
- **Nodemailer** – используется для отправки писем при восстановлении пароля.
- **Zod** – библиотека валидации входных данных для повышения безопасности.

#### Frontend:
- **Next.js (React)** – для построения динамичного интерфейса с SSR и SSG.
- **Bootstrap** – для стилизации интерфейса.

### 4. Показатели качества

- **Производительность**: Использование SSR, статической генерации страниц и кэширования запросов.
- **Масштабируемость**: Возможность развертывания через Docker, поддержка API и микросервисного подхода.
- **Безопасность**: Аутентификация через JWT-токены и сессионные куки, защита API-эндпоинтов, безопасное хранение данных в PostgreSQL.
- **Надёжность**: Централизованное логирование и обработка ошибок.

### 5. Реализация сквозной функциональности

- **Безопасность**: Хеширование паролей и проверка jwt-токенов.
- **Обработка ошибок**: Реализация обработки ввода и работы с данными при работе с базой данных и сервисами для ифнормирования пользователя об ошибках
- **Валидация данных**: Обработчики запросов через API-роуты Next.js с валидацией Zod.

### 6. Структурная схема приложения

![Архитектура To be](https://github.com/WadimAndrianov/viewpont/blob/main/docs/architecture/to%20be.png)

## Часть 2. Анализ архитектуры («As Is»)

### 1. Анализ текущей структуры кода

В текущей реализации ViewPoint присутствуют следующие основные компоненты:

- **Аутентификация**: Реализована через форму входа, используется механизм JWT и сессий.
- **Хранение данных**: PostgreSQL через Prisma, хранит информацию о пользователях.
- **Фронтенд**: Включает регистрацию, вход и приветственное окно.
- **Отправка писем**: Nodemailer используется для восстановления паролей.

### 2. Структурная схема текущей реализации

![Архитектура As is](https://github.com/WadimAndrianov/viewpont/blob/main/docs/architecture/is%20as.png)

## Часть 3. Сравнение и рефакторинг

### 1. Сравнение «To Be» и «As Is»

- **To Be**: Запланированы страницы для добавления и просмотра отзывов, улучшенное взаимодействие с базой данных, добавления функционала для администратора, скрытие части функционала для неавторизованных пользователй.
- **As Is**: Реализованы основные функции аутентификации, но отсутствуют страницы работы с продуктами и страницы для администрирования приложения.

### 2. Выявленные отличия

- **Фронтенд**: В текущей версии есть базовая аутентификация, но отсутствуют страницы для работы с продуктами и страницы для администратора.
- **База данных**: Сейчас хранятся только пользователи, но планируется добавить таблицы с отзывами и категориями.

### 3. Пути улучшения архитектуры

- **Добавление страниц отзывов**: Разработка интерфейса для просмотра и публикации отзывов.
- **Оптимизация базы данных**: Добавление новых таблиц для хранения отзывов и категорий продуктов.
- **Улучшение API**: Расширение API-роутов для работы с отзывами, защита эндпоинтов.

---

## Вывод

Сравнение запланированной («To Be») и текущей («As Is») архитектур ViewPoint выявило ключевые области для улучшения. Основные доработки касаются создания функционала отзывов, расширения базы данных и оптимизации API-запросов. Реализация этих улучшений позволит сделать проект более функциональным, удобным и масштабируемым.
